<!DOCTYPE html>
<html> 
  <head>
    <title> Education and Poverty</title>
    <link rel ="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.0/jquery.min.js"></script>
    <link rel="stylesheet" href="style05.css">
  
    <style>
      #map {height: 400px; width: 680px; margin: 10px; }
      #map2 {height: 400px; width: 680px; margin: 10px; }

      html, body { height: 100%; margin: 0; padding: 0; }

      .table {
        color: #ffffff;
      }
      .row {
               display: flex;
               flex-flow: row nowrap;
           }
           
       .col {
           display: flex;
           flex-flow: column nowrap;
       }

      .center {
          margin: auto;
          width: 50%;
          padding: 10px;
      }

      .button {
          display: inline-block;
          background-color: #00008B;
          padding: 5px;
          width: 150px;
          color: #ffffff;
          text-align: center;
          border: 4px double #ffffff; /* add this line */
          border-radius: 10px; /* add this line */
          font-size: 12px;
      }

    </style>

    <script src="WAPovertyData.geojson">
    </script>
    <script src="WAHighSchoolData.geojson">
    </script>
  
    <script>
      var schoolLayer;
      var schoolVisible = true;
      var povertyLayer;
      var povertyVisible = true;
      var OpenStreetMap_HOT = L.tileLayer('https://{s}.tile.openstreetmap.fr/hot/{z}/{x}/{y}.png',
                                          { maxZoom: 19, 
                                              attribution: '&copy; <a href="http:/www.openstreetmap.org/copyright">OpenStreetMap</a>, Tiles courtesy of <a href="http://hot.osm.org">HOT OSM</a>'
                                          });
        
      function schoolSymbology(feature) {
        var numDiplomas = feature.properties.Percent_Without_Diploma;
        var areaColor = "#00008B";

        if (numDiplomas > 14.7) {
          areaColor = "#eb5e0c"; 
        }
        if (numDiplomas > 25) {
          areaColor = "#eb0c0f"; 
        }
        return {
          color: areaColor,
          opacity: 1
        };
      }

      function povertySymbology(feature) {
        var numDiplomas = feature.properties.Percent_Living_in_Poverty;
        var areaColor = "#00008B";

        if (numDiplomas > 30) {
          areaColor = "#eb5e0c"; 
        }
        if (numDiplomas > 50) {
          areaColor = "#eb0c0f"; 
        }else{
          opacity: 1;
        }
        return {
          color: areaColor,
          opacity: 1
        };
      }
      
      function initialize() {
          var map = L.map('map', { 
                      center: [ 47.691, -122.278 ],
                      zoom: 7,
                      layers: [OpenStreetMap_HOT]
              });

          var responseSchool = $.ajax({
            url: "WAHighSchoolData.geojson",
            dataType: "json",
            success: console.log("school data loaded!"),
            error: function(xhr){
              alert(xhr.statusText);
            }
          });
        
        $.when(responseSchool).done(function() {
              schoolLayer = L.geoJson(responseSchool.responseJSON,
                            { style: schoolSymbology,
                            onEachFeature: function(feature, layer) {
                layer.bindPopup("<b> Number Without Diploma: " + feature.properties.Num_Without_Diploma + "<\b><br>" + "Census Tract: " + 
                                feature.properties.Census_Tract + "<br>" + "Percent Without Diploma: " + feature.properties.Percent_Without_Diploma);
              }
              }).addTo(map);
              $("#toggleSchool").show();
          
              $("#toggleSchool").click(function() {
                    if(schoolVisible) {
                      schoolVisible = false;
                      schoolLayer.removeFrom(map);
                    }else{
                      schoolVisible = true;
                      schoolLayer.addTo(map);
                    }
              }) 
        })

      //second map
        var map2 = L.map('map2', {
            center: [ 47.691, -122.278 ],
            zoom: 7,
            layers: [OpenStreetMap_HOT]
        });

        var responsePoverty = $.ajax({
          url: "WAPovertyData.geojson",
          dataType: "json",
          success: console.log("poverty data loaded!"),
          error: function(xhr){
            alert(xhr.statusText);
          }
        });

        $.when(responsePoverty).done(function() {
              povertyLayer = L.geoJson(responsePoverty.responseJSON,
                            { style: povertySymbology,
                            onEachFeature: function(feature, layer) {
                layer.bindPopup("Census Tract: " + feature.properties.Census_Tract + "<br>" + "Total Population: " + feature.properties.Total_Population + "<br>" + "Number living in Poverty " + 
                                feature.properties.Num_Living_in_Poverty + "<br>" + "Percent Living in Poverty: " + feature.properties.Percent_Living_in_Poverty);
              }
              }).addTo(map2);
              $("#togglePoverty").show();
          
              $("#togglePoverty").click(function() {
                    if(povertyVisible) {
                      povertyVisible = false;
                      povertyLayer.removeFrom(map2);
                    }else{
                      povertyVisible = true;
                      povertyLayer.addTo(map2);
                    }
              }) 
        })
  }  
          
    </script>
  </head>
  <body onload="initialize()"> 
    <h1><span style="background-color: #88ff88;">Visualizing the relationship between education and poverty</span></h1>
    Click on a county to view specific information!
    <div class = "row">
            
        <div class = "col">
            <h3 style ="font-family: montserrat; color: "#00008B">High school graduation data by county</h3> 
            <div id = "map"></div>
            <div class = "center" id = "button"><button id="toggleSchool" class = "button" hidden> Toggle to see Graduation Statistics </button></div>
        </div>
        
        <br>
        <div class = "col">
            <h3 style ="font-family: montserrat; color: #00008B">Poverty Data</h3> 
    
            <div id = "map2"></div>
            <div class = "center" id = "button"><button id="togglePoverty" class = "button" hidden> Toggle to see Poverty Statistics </button></div>
        </div>
    </div>
    <br>
    <div class = "center">
      The national average high school graduation rate is 85%. 
      In the map above I've highlighted the counties in Washington which have a percentage below that rate. 
    </div>
    
    <div class = "center">
    
    <h1 class = "center"><b>Highlights and Analsysis</b></h1>
  
    <table>
      <tr>
        <th colspan="4">Table of poverty and education data across Washington State ***Incorporate Census Data</th>
          
      <tr>
        <th>Census Tract</th>
        <th>Location</th>
        <th>Percent Without Diploma</th>
        <th>Percent Living in Poverty</th>
      </tr>

      <tr> 
        <td> 53025011402</td>
        <td>Grant County WA</td>
        <td>56.92</td>
        <td>50.48</td>
      </tr>

      <tr>
        <td>53053060200</td>
        <td>Tacoma, WA</td>
        <td>25.96</td>
        <td>52.54</td>
      </tr>

      <tr>
        <td>53027940000</td>
        <td>Amanda Park, WA</td>
        <td>17.46</td>
        <td>50.12</td>
      </tr>
    
    </table style="color:white">
    <p style="border-width:3px; border-style:solid; border-color:#00008B; padding:25px">
      
      These counties and cities are pulled from different regions of the state.
      And I wanted to take into accoutn the variables of different ethnic build-ups, local economies, etc. so 
      I picked these very different cities. 
      
    </p>
      
    <h2 class = "center"><b>     Further Considerations</b></h2>
    <p style="border-width:3px; border-style:solid; border-color:#00008B; padding:25px">
        Through this visual interpretation, my goal was to solidify the correlation between education and poverty levels.
        However, with education, there is many levels of nuance that must be examined, such ash the <b><i>1. quality of education 2. size of classroom 3. public vs. private education</i></b>
        As all these factors play a role into determining how successful one may become after their education. 
        In addition, no two states, counties, or cities are the same. Each have their unique set of opportunities and challenges, thus making this issue a fascinating one at each level of government. 
  
        While I wanted to shed light on this topic, my hope is that I can further take part in diving deeper into this issue and using tools like geojson and html to continue 
        creating visual graphics to alert attention to this issue.
    </p>
    </div>
    <br>
    <div class = "center">
      <h2><b>Data Sources & References</b></h2>
        https://geo.wa.gov/datasets/WADOH::population-living-in-poverty-current-version/explore
        https://geo.wa.gov/datasets/WADOH::no-high-school-diploma-current-version/explore
        https://www.thinkimpact.com/high-school-statistics/#:~:text=High%20School%20Graduation%20Rates&text=Graduation%20rates%20can%20also%20outline,%2C%20an%20all%2Dtime%20high.
    </div>
  </body>
</html>
