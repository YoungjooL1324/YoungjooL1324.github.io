<!DOCTYPE html>
<html> 
  <head>
    <title> Hello Campus!</title>
    <link rel ="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.0/jquery.min.js"></script>
  
    <style>
      #map { height: 400px; width: 700px; }
      html, body { height: 100%; margin: 0; padding: 0; }
    </style>

    <script src="nhCoastalRegions.geojson">
    </script>
    <script src="WAHighSchoolData.geojson">
    </script>
  
    <script>
      var schoolLayer;
      var schoolVisible = true;
      var coastVisible = true;
      var OpenStreetMap_HOT = L.tileLayer('https://{s}.tile.openstreetmap.fr/hot/{z}/{x}/{y}.png',
                                          { maxZoom: 19, 
                                              attribution: '&copy; <a href="http:/www.openstreetmap.org/copyright">OpenStreetMap</a>, Tiles courtesy of <a href="http://hot.osm.org">HOT OSM</a>'
                                          });
        
      function schoolSymbology(feature) {
        var numDiplomas = feature.properties.Percent_Without_Diploma;
        var areaColor = "#00008B";

        if (numDiplomas > 25) {
          areaColor = "#eb5e0c"; 
        }
        if (numDiplomas > 50) {
          areaColor = "#eb0c0f"; 
        }

        return {
          color: areaColor,
          opacity: 1
        };
      }
      function initialize() {
          var map = L.map('map', { 
                      center: [ 47.636, -122.075 ],
                      zoom: 10,
                      layers: [OpenStreetMap_HOT]
              });
          var response = $.ajax({
            url: "WAHighSchoolData.geojson",
            dataType: "json",
            success: console.log("school data loaded!"),
            error: function(xhr){
              alert(xhr.statusText);
            }
          });
        
        $.when(response).done(function() {
              schoolLayer = L.geoJson(response.responseJSON,
                            { style: schoolSymbology,
                            onEachFeature: function(feature, layer) {
                layer.bindPopup("<b> Number Without Diploma: " + feature.properties.Num_Without_Diploma + "<\b><br>" + "Census Tract: " + 
                                feature.properties.Census_Tract + "<br>" + "Percent Without Diploma: " + feature.properties.Percent_Without_Diploma);
              }
              }).addTo(map);
              $("#toggleSchool").show();
              $("#toggleSchool").click(function() {
                    if(schoolVisible) {
                      schoolVisible = false;
                      schoolLayer.removeFrom(map);
                    }else{
                      schoolVisible = true;
                      schoolLayer.addTo(map);
                    }
              }) 
        })
        L.geoJson(coast_geojson,
        { color: "ee87ff",
        weight: 5,
        opacity: .5,
        onEachFeature: function(feature, layer) {
          layer.bindPopup("<b> Coast Name: " + feature.properties.Site_Name + "<\b>");
        }
        });
    
  }  
          
    </script>
  </head>
  <body onload="initialize()"> 
    <h1>Hello Campus!</h1>
    <div id = "map"></div>
    <div id = "button">
      <button id="toggleSchool" hidden> Toggle the layers.</button>
    </div>
  </body>
</html>
